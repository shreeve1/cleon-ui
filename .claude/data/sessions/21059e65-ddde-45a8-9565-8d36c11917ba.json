{
  "session_id": "21059e65-ddde-45a8-9565-8d36c11917ba",
  "prompts": [
    "# Claude Code Starter Prompt\n\n## Initial Build Prompt\n\n```markdown\nBuild a multi-agent orchestration web UI for managing parallel Claude Code instances.\n\n## Tech Stack\n- Backend: Node.js + TypeScript + Express + ws (WebSocket) + node-pty\n- Frontend: React 18 + TypeScript + Vite + Tailwind CSS\n- Single repo with `backend/` and `frontend/` directories\n\n## MVP Scope (Day 1)\n\n### Backend Requirements\n\n1. **Agent Manager** (`backend/src/agent-manager.ts`)\n   - AgentRegistry class with Map<string, Agent> storage\n   - `spawnAgent(name, systemPrompt?, model?)` - spawn claude CLI via node-pty\n   - `killAgent(name)` - terminate PTY process\n   - `sendCommand(name, text)` - write to agent's stdin\n   - `getAgentLogs(name, count)` - return recent output\n\n2. **Output Parser** (`backend/src/output-parser.ts`)\n   - Parse Claude Code stdout for event detection\n   - Emit structured events: RESPONSE, TOOL, THINKING, HOOK\n   - Track approximate token/cost from output patterns\n\n3. **WebSocket Server** (`backend/src/server.ts`)\n   - Express serving frontend static files\n   - WS endpoint at `/ws`\n   - Broadcast log events to all connected clients\n   - Handle: create_agent, delete_agent, command_agent, list_agents\n\n### Frontend Requirements\n\n1. **Layout** (3-column + bottom input)\n   - Left sidebar: Agent cards with status/context/cost\n   - Center: Scrolling log stream with auto-follow\n   - Right sidebar: Orchestrator action log\n   - Bottom: Multi-line prompt input\n\n2. **Components**\n   - `AgentSidebar` - List of AgentCard components\n   - `AgentCard` - Name, status badge, context 7/200k, cost $0.12\n   - `LogStream` - Virtualized list of log entries\n   - `LogEntry` - Timestamp, event type (color-coded), agent name, content\n   - `PromptInput` - Textarea with Enter to send, Shift+Enter newline\n\n3. **WebSocket Hook** (`useWebSocket.ts`)\n   - Connect to ws://localhost:5175/ws\n   - Reconnect on disconnect\n   - Dispatch messages to state\n\n### Agent Spawn Command\n```typescript\nspawn('claude', ['--print'], {\n  name: 'xterm-color',\n  cwd: workingDir,\n  env: { ...process.env }\n});\n```\n\n### Event Types\n```typescript\ntype LogEventType = 'HOOK' | 'RESPONSE' | 'TOOL' | 'THINKING';\n\ninterface LogEntry {\n  id: string;\n  timestamp: Date;\n  type: LogEventType;\n  event: string;  // e.g., \"USERPROMPTSUBMIT\", \"STOP\"\n  content: string;\n  agentName: string;\n}\n```\n\n### WebSocket Protocol\n```typescript\n// Client -> Server\n{ type: 'create_agent', name: string, systemPrompt?: string }\n{ type: 'delete_agent', name: string }\n{ type: 'command_agent', name: string, command: string }\n{ type: 'list_agents' }\n\n// Server -> Client\n{ type: 'agent_created', agent: Agent }\n{ type: 'agent_deleted', name: string }\n{ type: 'agent_updated', name: string, updates: Partial<Agent> }\n{ type: 'log', entry: LogEntry }\n{ type: 'agents', agents: Agent[] }\n```\n\n## File Structure\n```\nmulti-agent-ui/\n\u251c\u2500\u2500 backend/\n\u2502   \u251c\u2500\u2500 src/\n\u2502   \u2502   \u251c\u2500\u2500 index.ts\n\u2502   \u2502   \u251c\u2500\u2500 server.ts\n\u2502   \u2502   \u251c\u2500\u2500 agent-manager.ts\n\u2502   \u2502   \u251c\u2500\u2500 output-parser.ts\n\u2502   \u2502   \u2514\u2500\u2500 types.ts\n\u2502   \u251c\u2500\u2500 package.json\n\u2502   \u2514\u2500\u2500 tsconfig.json\n\u251c\u2500\u2500 frontend/\n\u2502   \u251c\u2500\u2500 src/\n\u2502   \u2502   \u251c\u2500\u2500 App.tsx\n\u2502   \u2502   \u251c\u2500\u2500 main.tsx\n\u2502   \u2502   \u251c\u2500\u2500 components/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 AgentSidebar.tsx\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 AgentCard.tsx\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 LogStream.tsx\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 LogEntry.tsx\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 OrchestratorPanel.tsx\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 PromptInput.tsx\n\u2502   \u2502   \u251c\u2500\u2500 hooks/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 useWebSocket.ts\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 useAgents.ts\n\u2502   \u2502   \u2514\u2500\u2500 types.ts\n\u2502   \u251c\u2500\u2500 index.html\n\u2502   \u251c\u2500\u2500 package.json\n\u2502   \u251c\u2500\u2500 vite.config.ts\n\u2502   \u2514\u2500\u2500 tailwind.config.js\n\u2514\u2500\u2500 package.json (workspace)\n```\n\n## Styling Reference\n- Background: dark (#0d1117 or similar)\n- Agent cards: dark panels with subtle borders\n- Status badges: IDLE (blue), RUNNING (green), ERROR (red)\n- Log event colors: HOOK (cyan), RESPONSE (green), TOOL (yellow), THINKING (purple)\n- Accent: teal/cyan (#22d3ee)\n\n## Start Here\n1. Initialize the monorepo structure\n2. Build backend agent-manager.ts first\n3. Add WebSocket server\n4. Create minimal React frontend\n5. Connect WebSocket and test single agent\n6. Add multi-agent support\n7. Polish UI to match reference\n\nBegin implementation now. Start with backend/src/agent-manager.ts.\n```\n\n---\n\n## Phase 2 Prompt (After MVP Works)\n\n```markdown\nExtend the multi-agent orchestrator with:\n\n1. **Slash Commands** (`.claude/commands/`)\n   - Autocomplete dropdown on `/` in prompt input\n   - Load markdown files as command templates\n   - Support $ARGUMENTS placeholder substitution\n\n2. **Agent Templates** (`.claude/templates/`)\n   - Pre-configured system prompts\n   - Quick-spawn buttons in UI\n   - Templates: meta-agent, build-agent, review-agent, scout-agent\n\n3. **Orchestrator Tools**\n   - O-Agent panel shows orchestrator actions\n   - Tool palette reference in UI footer\n   - create_agent, list_agents, command_agent, check_agent_status, delete_agent, interrupt_agent\n\n4. **Log Filtering**\n   - Toggle buttons for RESPONSE, TOOL, THINKING, HOOK\n   - Search box for log content\n   - Filter by agent name\n\n5. **Keyboard Shortcuts**\n   - Ctrl+1: Run prompt in parallel across all agents\n   - Ctrl+2: Run then summarize results\n   - Ctrl+3: Run and compare outputs\n   - Esc: Clear input / close dialogs\n\n6. **Cost Tracking**\n   - Parse Claude output for token counts\n   - Estimate cost per model\n   - Show cumulative session cost in header\n```\n\n---\n\n## Validation Checklist\n\nAfter each phase, verify:\n\n- [ ] Backend starts without errors: `cd backend && npm run dev`\n- [ ] Frontend starts: `cd frontend && npm run dev`\n- [ ] WebSocket connects (check browser console)\n- [ ] Can create agent via UI\n- [ ] Agent output appears in log stream\n- [ ] Can send commands to agent\n- [ ] Can delete agent\n- [ ] Multiple agents work independently\n- [ ] UI matches reference screenshots (dark theme, 3-column layout)\n"
  ]
}